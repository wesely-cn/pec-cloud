version: '3'
services:
  pec-cloud:
    image: pec-cloud:0.0.1
    container_name: pec-cloud
    ports:
      - "6100:6100"
      - "6666:6666"
    volumes:
      - ./log:/app/log
      - ./data:/app/data
      - ./config/config.json:/app/config.json
      - ./config/log.yaml:/app/log.yaml
    environment:
      - FLASK_ENV=production
      - LOG_LEVEL=INFO
      - SERVER_PORT=6000
    restart: unless-stopped
    networks:
      - app-network
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:6100/api/health"]
      interval: 30s
      timeout: 10s
      retries: 3
#      start_period: 40s

networks:
  app-network:
    driver: bridge
